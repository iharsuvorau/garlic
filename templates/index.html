<!DOCTYPE html>
<html lang="en">
<head>{{template "head" .}}</head>
<body>
{{template "site-header" .}}
<section class="introduction">
    <h1 class="h1">Sessions Control</h1>
    <p>This dashboard allows the control of the Pepper robot through the local network simply by clicking corresponding
        buttons, either <em>questions</em>, or <em>positive answers</em>, or <em>negative answers</em>. On the right
        side, there is available <em>the general motion library</em>, so a user can initiate any movement at any time.
    </p>
</section>
<main class="sessions-control">
    <section class="sessions">
        <div class="mb2">
            <h2 class="h2 mb1">{{if .currentSessionName}}{{.currentSessionName}}{{else}}Choose a session{{end}}</h2>
            <select name="sessions" id="sessionList" class="">
                <option value="">Please, select the session</option>
                {{range .sessions}}
                    <option value="{{.ID}}" {{if eq .ID $.currentSessionID}}selected{{end}}>{{.Name}}</option>
                {{end}}
            </select>
        </div>

        <section class="session">
            {{range .sessions}}
                {{if eq .ID $.currentSessionID}}
                    {{$questionCounter := 0}}
                    {{range .Items}}
                        {{$questionCounter = ($questionCounter | increment)}}
                        {{/* each HTML element must have an ID in order to be recognized and be found later in the
                        JS script to mark it as "visited" or "active" */}}
                        <div class="session-item">

                            <div id="{{.Question.ID}}" class="question say-move-item" data-itemid="{{.Question.ID}}">
                                <p class="h6 bold caps" data-itemid="{{.Question.ID}}">Question {{$questionCounter}}</p>
                                <div data-itemid="{{.Question.ID}}">
                                    <p class="h2 mb0" data-itemid="{{.Question.ID}}">{{.Question.SayItem.Phrase}}</p>
                                    <p class="h6" data-itemid="{{.Question.ID}}">
                                        <span class="bold">audio</span>: {{.Question.SayItem.FilePath | basename}}
                                        <br/>
                                        {{if .Question.MoveItem}}
                                            <span class="bold">motion</span>: {{.Question.MoveItem.Name}}
                                            {{if.Question.MoveItem.Delay}}
                                                <span class="bold">with delay</span> of {{.Question.MoveItem.Delay}}
                                            {{end}}
                                        {{end}}
                                    </p>
                                    {{/* Hidden from UI */}}
                                    <audio id="audio-{{.Question.ID}}" src="/{{.Question.SayItem.FilePath}}">
                                        Your browser does not support the <code>audio</code> element.
                                    </audio>
                                </div>
                            </div>

                            <div class="answers">
                                {{if .PositiveAnswer}}
                                    <div id="{{.PositiveAnswer.ID}}" class="positive-answer say-move-item" data-itemid="{{.PositiveAnswer.ID}}">
                                        {{if .PositiveAnswer.SayItem}}
                                            <p class="h3 mb0 positive" data-itemid="{{.PositiveAnswer.ID}}">{{.PositiveAnswer.SayItem.Phrase}}</p>
                                        {{end}}
                                        <p class="h6" data-itemid="{{.PositiveAnswer.ID}}">
                                            {{if .PositiveAnswer.SayItem.FilePath}}
                                                audio: {{.PositiveAnswer.SayItem.FilePath | basename}}<br/>
                                            {{end}}
                                            {{if .PositiveAnswer.MoveItem}}
                                                motion: {{.PositiveAnswer.MoveItem.Name}}
                                            {{end}}
                                        </p>
                                        {{/* Hidden from UI */}}
                                        <audio id="audio-{{.PositiveAnswer.ID}}" src="/{{.Question.SayItem.FilePath}}">
                                            Your browser does not support the <code>audio</code> element.
                                        </audio>
                                    </div>
                                {{end}}

                                {{if .NegativeAnswer}}
                                    <div id="{{.NegativeAnswer.ID}}" class="negative-answer say-move-item" data-itemid="{{.NegativeAnswer.ID}}">
                                        {{if .NegativeAnswer.SayItem}}
                                            <p class="h3 mb0 negative" data-itemid="{{.NegativeAnswer.ID}}">{{.NegativeAnswer.SayItem.Phrase}}</p>
                                        {{end}}
                                        <p class="h6" data-itemid="{{.NegativeAnswer.ID}}">
                                            {{if .NegativeAnswer.SayItem.FilePath}}
                                                audio: {{.NegativeAnswer.SayItem.FilePath | basename}}<br/>
                                            {{end}}
                                            {{if .NegativeAnswer.MoveItem}}
                                                motion: {{.NegativeAnswer.MoveItem.Name}}
                                            {{end}}
                                        </p>
                                        {{/* Hidden from UI */}}
                                        <audio id="audio-{{.PositiveAnswer.ID}}" src="/{{.NegativeAnswer.SayItem.FilePath}}">
                                            Your browser does not support the <code>audio</code> element.
                                        </audio>
                                    </div>
                                {{end}}
                            </div>

                        </div>
                    {{end}}
                {{end}}
            {{end}}
        </section>

        <form action="/voice" method="post" style="display: none;">
            <div class="field">
                <label for="phrase">Phrase</label>
                <input id="phrase" name="phrase" type="text">
            </div>
            <div class="field">
                <input type="submit" value="Send"/>
            </div>
        </form>
    </section>

    <aside>
        <h2 class="h2">Motion Library</h2>
        {{range $group := .moveGroups}}
            <h3 class="h3">{{$group}}</h3>
            <div class="motion-group">
                {{range $.motions}}
                    {{if eq $group .Group}}
                        <div class="motion-item" id="{{.ID}}" data-itemid="{{.ID}}">{{.Name}}</div>
                    {{end}}
                {{end}}
            </div>
        {{end}}
    </aside>
</main>
{{template "body-bottom" .}}
</body>
</html>